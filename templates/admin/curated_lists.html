{% extends "admin/base.html" %}
{% set active_page = 'lists' %}

{% block title %}Curated Lists{% endblock %}

{% block content %}
<div class="page-header flex-between">
    <div>
        <h1>Curated Lists</h1>
        <p>Create and manage custom movie collections for users</p>
    </div>
</div>

<!-- Create New List -->
<div class="card">
    <h3 style="margin-bottom: 15px;">Create New List</h3>
    <form action="/admin/lists/create" method="post" style="display: flex; gap: 15px; flex-wrap: wrap; align-items: flex-end;">
        <div class="form-group" style="margin: 0; flex: 1; min-width: 200px;">
            <label for="label">Label</label>
            <input type="text" id="label" name="label" class="form-control" placeholder="e.g., Staff Picks" required>
        </div>
        <div class="form-group" style="margin: 0; flex: 1; min-width: 200px;">
            <label for="slug">Slug (URL)</label>
            <input type="text" id="slug" name="slug" class="form-control" placeholder="e.g., staff-picks" required pattern="[a-z0-9-]+">
        </div>
        <div class="form-group" style="margin: 0; flex: 2; min-width: 300px;">
            <label for="description">Description</label>
            <input type="text" id="description" name="description" class="form-control" placeholder="Optional description">
        </div>
        <button type="submit" class="btn btn-primary">Create List</button>
    </form>
</div>

<!-- Existing Lists -->
<div class="card">
    <h3 style="margin-bottom: 15px;">Existing Lists</h3>
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>Label</th>
                    <th>Slug</th>
                    <th>Movies</th>
                    <th>Status</th>
                    <th>Order</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for list in lists %}
                <tr>
                    <td><strong>{{ list.label }}</strong></td>
                    <td><code>/list/{{ list.slug }}</code></td>
                    <td>{{ list.movie_slugs | length }}</td>
                    <td>
                        {% if list.is_active %}
                        <span class="badge badge-active">Active</span>
                        {% else %}
                        <span class="badge badge-inactive">Inactive</span>
                        {% endif %}
                    </td>
                    <td>{{ list.display_order }}</td>
                    <td>
                        <div style="display: flex; gap: 8px;">
                            <a href="/admin/lists/{{ list.slug }}" class="btn btn-secondary btn-sm">Edit</a>
                            <a href="/list/{{ list.slug }}" target="_blank" class="btn btn-secondary btn-sm">View</a>
                        </div>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="6" style="text-align: center; padding: 40px; color: var(--text-muted);">
                        No curated lists yet. Create one above!
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<div class="card" style="background: rgba(255, 165, 2, 0.1); border: 1px solid rgba(255, 165, 2, 0.3);">
    <h4 style="margin-bottom: 10px; color: var(--secondary);">How Curated Lists Work</h4>
    <ul style="color: var(--text-muted); font-size: 0.9rem; margin-left: 20px;">
        <li>Active lists appear in the user navigation menu</li>
        <li>Add movies from the Movies dashboard using the "Add to list" dropdown</li>
        <li>Reorder lists using the Display Order field (lower = first)</li>
        <li>Users can browse lists at <code>/list/your-slug</code></li>
    </ul>
</div>
{% endblock %}
