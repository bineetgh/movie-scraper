<article class="movie-card" itemscope itemtype="https://schema.org/Movie" data-movie-slug="{{ movie.slug }}" data-genres="{{ movie.genres | join(',') }}">
    <a href="{{ movie.canonical_url }}">
        <div class="poster-container">
            {% if movie.poster_url %}
            <img src="{{ movie.poster_url }}"
                 alt="{{ movie.title }} poster"
                 itemprop="image"
                 loading="lazy"
                 class="movie-poster">
            {% else %}
            <div class="movie-poster" style="display: flex; align-items: center; justify-content: center; font-size: 3rem; color: var(--text-muted);">
                ðŸŽ¬
            </div>
            {% endif %}
        </div>

        <div class="movie-info">
            <h3 class="movie-title" itemprop="name">{{ movie.title }}</h3>
            <div class="movie-meta">
                {% if movie.year %}<span itemprop="datePublished">{{ movie.year }}</span>{% endif %}
                {% if movie.rating %}<span class="movie-rating" itemprop="aggregateRating" itemscope itemtype="https://schema.org/AggregateRating"><span itemprop="ratingValue">{{ movie.rating }}</span> IMDb</span>{% endif %}
            </div>
            {% if movie.synopsis %}
            <p class="movie-synopsis" itemprop="description">{{ movie.synopsis[:150] }}{% if movie.synopsis | length > 150 %}...{% endif %}</p>
            {% endif %}
            <div class="movie-services">
                {% if movie.is_free %}
                <span class="service-tag service-tag-free">Free</span>
                {% elif movie.has_subscription %}
                <span class="service-tag service-tag-sub">Subscription</span>
                {% elif movie.is_rentable or movie.is_buyable %}
                <span class="service-tag service-tag-rent">Rent / Buy</span>
                {% endif %}
            </div>
        </div>
    </a>

    <!-- Watched Button (on poster) -->
    <button class="watched-btn" onclick="event.preventDefault(); event.stopPropagation(); toggleWatched('{{ movie.slug }}')" title="Mark as watched">
        <span class="watched-text">Watched</span>
    </button>

    <!-- Star Rating -->
    <div class="star-rating">
        <span class="star" data-value="1" onclick="event.preventDefault(); event.stopPropagation(); setRating('{{ movie.slug }}', 1)" title="1 star">â˜†</span>
        <span class="star" data-value="2" onclick="event.preventDefault(); event.stopPropagation(); setRating('{{ movie.slug }}', 2)" title="2 stars">â˜†</span>
        <span class="star" data-value="3" onclick="event.preventDefault(); event.stopPropagation(); setRating('{{ movie.slug }}', 3)" title="3 stars">â˜†</span>
        <span class="star" data-value="4" onclick="event.preventDefault(); event.stopPropagation(); setRating('{{ movie.slug }}', 4)" title="4 stars">â˜†</span>
        <span class="star" data-value="5" onclick="event.preventDefault(); event.stopPropagation(); setRating('{{ movie.slug }}', 5)" title="5 stars">â˜†</span>
    </div>
</article>
