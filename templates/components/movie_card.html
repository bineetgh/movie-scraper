<article class="movie-card" itemscope itemtype="https://schema.org/Movie" data-movie-slug="{{ movie.slug }}" data-genres="{{ movie.genres | join(',') }}">
    <a href="{{ movie.canonical_url }}">
        <div class="poster-container">
            {% if movie.poster_url %}
            <img src="{{ movie.poster_url }}"
                 alt="{{ movie.title }} poster"
                 itemprop="image"
                 loading="lazy"
                 class="movie-poster">
            {% else %}
            <div class="movie-poster" style="display: flex; align-items: center; justify-content: center; font-size: 3rem; color: var(--text-muted);">
                ğŸ¬
            </div>
            {% endif %}
            <span class="watched-badge" style="display: none;">Watched</span>
        </div>

        <div class="movie-info">
            <h3 class="movie-title" itemprop="name">{{ movie.title }}</h3>
            <div class="movie-meta">
                {% if movie.year %}<span itemprop="datePublished">{{ movie.year }}</span>{% endif %}
                {% if movie.rating %}<span class="movie-rating" itemprop="aggregateRating" itemscope itemtype="https://schema.org/AggregateRating"><span itemprop="ratingValue">{{ movie.rating }}</span> IMDb</span>{% endif %}
            </div>
            {% if movie.synopsis %}
            <p class="movie-synopsis" itemprop="description">{{ movie.synopsis[:150] }}{% if movie.synopsis | length > 150 %}...{% endif %}</p>
            {% endif %}
            <div class="movie-services">
                {% if movie.is_free %}
                <span class="service-tag service-tag-free">Free</span>
                {% elif movie.has_subscription %}
                <span class="service-tag service-tag-sub">Subscription</span>
                {% elif movie.is_rentable or movie.is_buyable %}
                <span class="service-tag service-tag-rent">Rent / Buy</span>
                {% endif %}
            </div>
        </div>
    </a>

    <!-- User Actions (watched, reactions) -->
    <div class="movie-actions-bar">
        <button class="watched-btn" onclick="event.preventDefault(); toggleWatched('{{ movie.slug }}')" title="Mark as watched">
            <span class="watched-icon">ğŸ‘</span>
            <span class="watched-text">Watched</span>
        </button>
        <div class="reaction-btns">
            <button class="reaction-btn" data-reaction="loved" onclick="event.preventDefault(); setReaction('{{ movie.slug }}', 'loved')" title="Loved it">ğŸ˜</button>
            <button class="reaction-btn" data-reaction="liked" onclick="event.preventDefault(); setReaction('{{ movie.slug }}', 'liked')" title="Liked it">ğŸ‘</button>
            <button class="reaction-btn" data-reaction="disliked" onclick="event.preventDefault(); setReaction('{{ movie.slug }}', 'disliked')" title="Didn't like it">ğŸ‘</button>
        </div>
    </div>
</article>
